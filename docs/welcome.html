<html>
<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Godhra Jamaat</title>
  <meta name="author" content="Burhanuddin Hamzabhai">
<link href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css" rel="stylesheet">
<script type="text/javascript" src="test/credentials.json"></script>
<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/8.9.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.9.0/firebase-database.js"></script>
<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/8.9.0/firebase-analytics.js"></script>

<style>
  table {
    font-family: arial, sans-serif;
    border-collapse: collapse;
    width: 100%;
  }
  
  td, th {
    border: 1px solid #dddddd;
    text-align: left;
    padding: 8px;
 }
  
  tr:nth-child(even) {
    background-color: #dddddd;
  }
  </style>
  <style type="text/css">
  body{
    background-repeat: repeat;
    background: linear-gradient(rgba(255,255,255,.7), rgba(255,255,255,.7)), url("bg.jpg");
     
}

html{
  -webkit-user-select: none;
-khtml-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
-o-user-select: none;
user-select: none;
}
.content{
    display: none;
}
.loader{
    height: 100vh;
    width: 100vw;
    overflow: hidden;
    background-color: #f1eee9;
    position: absolute;
}
.loader>div{
    height: 100px;
    width: 100px;
    border: 15px solid #fff;
    border-top-color: #8a2900;
    position: absolute;
    margin: auto;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    border-radius: 50%;
    animation: spin 1.5s infinite linear;
}
@keyframes spin{
    100%{
        transform: rotate(360deg);
    }
}
</style>
</head>
<body oncontextmenu="return false">
  <div class="loader">
        <div></div>
    </div>
 <section class="content text-gray-600 body-font">
   <!-- <div style="height: 60px; width:100%; top:0; background-color: #f1eee9; box-shadow: 0 3px 10px -6px #777;position: fixed;"class="">
      <h1 id="wText" class="sm:text-xl text-xl text-center font-semibold title-font text-gray-700 bg-black" style="line-height: 60px;">Burhanuddin Mulla Hamzabhai<span id="logoutBtn" class=" font-bold text-green-900 bg-white border-0 py-2 px-6 focus:outline-none hover:bg-green-600 hover:text-white rounded text-lg text-right">Logout</span></h1>
      <button >Logout</button>

    </div> -->
          <header style="height: 60px; width:100%; top:0; background-color: #f1eee9; box-shadow: 0 3px 10px -6px #eadfce;position: fixed;">
        <div class="container mx-auto flex flex-wrap flex-col md:flex-row items-center">
            <nav class="flex lg:w-1/5 flex-wrap items-center text-base md:ml-auto">
                </nav>
            <a
                class="flex order-first lg:order-none w-3/5    title-font font-medium items-center lg:items-center lg:justify-center">
                <span class="ml-3 text-xl"style="line-height:60px;"id="wText"></span>
            </a>
            <div class="lg:w-1/5 inline-flex lg:justify-end ml-5 lg:ml-0">
                <button class="text-white ml-4 py-2 px-3 rounded-lg" id="logoutBtn" style="background-color: #8a2900;">
                    Logout
                </button>
            </div>
        </div>
    </header>
      <h1 class="mt-20 text-center text-blue-600 font-bold text-4xl sm\:text-2xl">Dawoodi Bohra Jamaat Godhra</h1>
      <h1 class="text-center lg\:text-gray-700 font-medium text-2xl sm\:text-2xl">Ashara Mubaraka 1443H</h1>
      
      <div style="width: 70%; height: 40px; background-color: #eadfce;" class="mx-auto rounded mt-10">
        <h1 class="ml-5 lg\:text-gray-800 font-medium text-lg" style="line-height: 40px;">Ashara Mubaraka 1443H Live Relay</h1>
      </div>
      <div style="width: 70%; height: auto; padding: 30px 40px; background-color: #fff;
      box-shadow:
      0 2.8px 2.2px rgba(0, 0, 0, 0.034),
      0 6.7px 5.3px rgba(0, 0, 0, 0.048),
      0 12.5px 10px rgba(0, 0, 0, 0.06),
      0 0px 0px rgba(0, 0, 0, 0.072),
      0 0px 0px rgba(0, 0, 0, 0.086),
      0 0px 0px rgba(0, 0, 0, 0.12);" class="mx-auto rounded mb-10">
      	<iframe scrolling src="https://account3.livebox.co.in/livebox/player/?chnl=dawoodi" class=" object-cover object-center rounded" style="width: 100%; height: 60%;" allowfullscreen webkitallowfullscreen mozallowfullscreen oallowfullscreen msallowfullscreen allow="autoplay" ></iframe>  
      </div>
      

   <!-- <div class="container mx-auto flex px-5 items-center justify-center flex-col align-middle h-screen mt-20">
    
    <div class="text-center lg:w-2/3 w-full">
      <div class="flex justify-center">
        <button id="logoutBtn" class="inline-flex font-bold text-green-900 bg-white mb-10 border-0 py-2 px-6 focus:outline-none hover:bg-green-600 hover:text-white rounded text-lg">Logout</button>
      </div>
    </div>
  </div> -->
</section>
<div id="forAdmin" style="visibility: hidden; background-color: #fff;">
  <button class="text-white border-0 py-2 px-8 focus:outline-none hover:bg-blue-600 text-lg w-full" id="downloadData" onclick="exportData()" style="background-color: #8a2900;">Export Data</button>
  <table>
  <tr><th id="totalCount" colspan="4" style="text-align: center;"></th></tr>
  <tr>
<th>Its Num</th>
<th>Name</th>
<th>Login Day</th>
<th>Login Time</th>
</tr>
  <tbody id="itsdata"></tbody>
</table>
</div>
	<!-- <footer class="text-white body-font">
  
  <div class=""  style="background:#009866;">
    <div class="container mx-auto py-4 px-5 flex flex-wrap flex-col sm:flex-row">
      <p class="text-white text-sm text-center sm:text-left">Developed By â€”
        <a href="http://dot53.in/websolutions.html" class="text-white ml-1" target="_blank" rel="noopener noreferrer">Dot53 Web Solutions</a>
      </p>
      <span class="sm:ml-auto sm:mt-0 mt-2 sm:w-auto w-full sm:text-left text-center text-white text-sm"><a href="https://burhanuddinhamzabhai.dev/">Burhanuddin Hamzabhai</a></span>
    </div>
  </div>
</footer> -->
<script>
        $(window).on('load',function(){
            $(".loader").fadeOut(1000);
            $(".content").fadeIn(1000);
        });
    </script>
<script type="text/javascript">
 $(document).ready(function(){  
	 //window.history.replaceState('','','/');
  $("#logoutBtn").click(function(){
   document.cookie = "ITS=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
   window.location.href="index.html";
  });

  var d=document.cookie;
  var name = "ITS=";
  var decodedCookie = decodeURIComponent(document.cookie);
  var ca = decodedCookie.split(';');
  var cv="";
  for(var i = 0; i <ca.length; i++) {
   var c = ca[i];
   while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      cv=c.substring(name.length, c.length);
      break;
    }
  }
  if(cv=="")
  {
   window.location.href="index.html";
  }
  else
  {
   $("#wText").append(cv);

   if(cv == "Husain bhai  Saifuddin bhai Bhikhapurwala" || cv == "Aliasgar bhai  Najmuddin bhai Saherwala "){
   document.getElementById('forAdmin').style.visibility = "visible";
    var credentials = JSON.parse(data)
  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
  apiKey: credentials[0].apiKey,
  authDomain: credentials[0].authDomain,
  databaseURL: credentials[0].databaseURL,
  projectId: credentials[0].projectId,
  storageBucket: credentials[0].storageBucket,
  messagingSenderId: credentials[0].messagingSenderId,
  appId: credentials[0].appId,
  measurementId: credentials[0].measurementId
};
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  firebase.analytics();
 var database = firebase.database()
    var database = firebase.database();
    firebase.database().ref('Ashara-Day-2-Vaaz/').on('value',(snap)=>{
    var totalRecord =  snap.numChildren();
    console.log("Total Record : "+totalRecord);
   
    var totalRecord =  snap.numChildren();
    var totalRecordCount = document.getElementById('totalCount');
    
    var table = document.getElementById('itsdata');
    snap.forEach(function(childSnapshot) {
      var childKey = childSnapshot.key;
      var childData = childSnapshot.val();
      totalRecordCount.innerHTML = "Total Records " + "for "+ childData.loginDay + " Raat Majlis : " +totalRecord;
      let row = table.insertRow();
      let its = row.insertCell(0);
      its.innerHTML = childData.its;
      let name = row.insertCell(1);
      name.innerHTML = childData.user;
      let day = row.insertCell(2);
      day.innerHTML = childData.loginDay;
      let time = row.insertCell(3);
      time.innerHTML = childData.loginTime;
      
    });
  });
   }
  }
  
});
function exportData(){
    /* Get the HTML data using Element by Id */
    var table = document.getElementById("itsdata");
 
    /* Declaring array variable */
    var rows =[];
        column1 = "ITS Number";
        column2 = "Username";
        column3 = "Login Day";
        column4 = "Login Time";
        rows.push(
            [
                column1,
                column2,
                column3,
                column4
            ]
        );
      //iterate through rows of table
    for(var i=0,row; row = table.rows[i];i++){
        //rows would be accessed using the "row" variable assigned in the for loop
        //Get each cell value/column from the row
        column1 = row.cells[0].innerText;
        column2 = row.cells[1].innerText;
        column3 = row.cells[2].innerText;
        column4 = row.cells[3].innerText;
 
    /* add a new records in the array */
        rows.push(
            [
                column1,
                column2,
                column3,
                column4
            ]
        );
 
        }
        csvContent = "data:text/csv;charset=utf-8,";
         /* add the column delimiter as comma(,) and each row splitted by new line character (\n) */
        rows.forEach(function(rowArray){
            row = rowArray.join(",");
            csvContent += row + "\r\n";
        });
 
        /* create a hidden <a> DOM node and set its download attribute */
        var encodedUri = encodeURI(csvContent);
        var link = document.createElement("a");
        link.setAttribute("href", encodedUri);
        link.setAttribute("download", "Ashara Mubaraka 1443H.csv");
        document.body.appendChild(link);
        link.click();
}

</script>
<script>
      window.oncontextmenu = function () {
            return false;
        }
        $(document).keydown(function (event) {
            if (event.keyCode == 123) {
                return false;
            }
            else if ((event.ctrlKey && event.shiftKey && event.keyCode == 73) || (event.ctrlKey && event.shiftKey && event.keyCode == 74)) {
                return false;
            }
        });  
</script>
</body>
</html>

